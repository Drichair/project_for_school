{% extends 'base/base.html' %}

{% block content %}
<div class="row mt-5">
  <div class="col">
    <h4>Найти голосование по номеру</h4>
    <form id="view_voting_form">
      <div class="form-group row">
        <label for="voting_id" class="col-sm-2 col-form-label col-form-label-lg">Номер:</label>
        <div class="col-sm-8">
          <input type="number" class="form-control form-control-lg" id="voting_id" placeholder="введите номер голосования">
        </div>
        <div class="col-sm-2">
          <input type="submit" class="form-control form-control-lg btn btn-primary" value="Найти" onclick="vtbutton()">
        </div>
      </div>
    </form>
  </div>
</div>

<table class="table table-hover table-striped border shadow p-3 mt-5 mb-5 bg-white rounde">
  <thead>
    <tr>
      <th scope="col">Автор:</th>
      <th scope="col">Название голосования:</th>
      <th scope="col">Дата создания:</th>
      <th scope="col">Взаимодействие:</th>
    </tr>
  </thead>

  <tbody>
  {% for voting in votings %}
    <tr>
      <td>{{ voting.author.username }}</td>
      <td>
        <a href="{% url 'voting_public' voting.id %}">{{ voting.title }}</a>
        <div class="form-text">{{voting.description}}</div>
      </td>
      <td>{{ voting.published_at }}</td>
      <td>
        <a href="{% url 'complaint' voting.id %}"
           class="btn btn-warning mt-2"
           title="Отметить нарушение">
          <i class="bi bi-emoji-angry"></i>
        </a>
        {% if user.id == voting.author.id %}
          <a href="{% url 'voting_edit' voting.id %}"
             class="btn btn-primary mt-2"
             title="Редактировать голосование">
            <i class="bi bi-pencil-square"></i>
          </a>
          <a href="{% url 'voting_delete' voting.id %}"
             class="btn btn-danger mt-2"
             title="Удалить голосование">
            <i class="bi bi-trash-fill"></i>
          </a>
        {% else %}
          <a href="{% url 'voting_edit' voting.id %}"
             class="btn btn-primary mt-2 disabled"
             title="Редактировать голосование">
            <i class="bi bi-pencil-square"></i>
          </a>
          <a href="{% url 'voting_delete' voting.id %}"
             class="btn btn-danger mt-2 disabled"
             title="Удалить голосование">
            <i class="bi bi-trash-fill"></i>
          </a>
        {% endif %}
      </td>
    </tr>
  {% endfor %}
  </tbody>
</table>
<br>
<br>
{% endblock %}

{% block extra_js %}
<script type="text/javascript">
  function vtbutton(snbutton) {
    var vtbutton = document.getElementById("voting_id").value;
    document.getElementById('view_voting_form').action = "{% url 'voting_public' 1 %}".replace(/1/, vtbutton.toString());
  }
</script>
{% endblock %}